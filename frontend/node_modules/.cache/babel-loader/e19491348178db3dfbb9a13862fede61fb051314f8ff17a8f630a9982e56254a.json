{"ast":null,"code":"import React,{createContext,useState,useEffect}from'react';import axiosInstance from'../utils/axios';import{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[auth,setAuth]=useState({isAuthenticated:false,user:null,token:null});// Initialize auth state from localStorage on app load\nuseEffect(()=>{const user=localStorage.getItem('user');if(user){try{const userData=JSON.parse(user);setAuth({isAuthenticated:true,user:userData,token:userData.token||null});// Set the default authorization header for axios\nif(userData.token){axiosInstance.defaults.headers.common['Authorization']=`Bearer ${userData.token}`;}}catch(error){console.error('Error parsing user data from localStorage:',error);localStorage.removeItem('user');}}},[]);// Update auth state handler\nconst updateAuth=authData=>{var _authData$user;setAuth(authData);// Update axios default headers when auth changes\nif(authData.isAuthenticated&&(_authData$user=authData.user)!==null&&_authData$user!==void 0&&_authData$user.token){axiosInstance.defaults.headers.common['Authorization']=`Bearer ${authData.user.token}`;}else{delete axiosInstance.defaults.headers.common['Authorization'];}};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{...auth,setAuth:updateAuth},children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","axiosInstance","jsx","_jsx","AuthContext","AuthProvider","_ref","children","auth","setAuth","isAuthenticated","user","token","localStorage","getItem","userData","JSON","parse","defaults","headers","common","error","console","removeItem","updateAuth","authData","_authData$user","Provider","value"],"sources":["C:/Users/isuru/Documents/SLIIT/y3paf/skill-bridge/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport axiosInstance from '../utils/axios';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [auth, setAuth] = useState({\r\n    isAuthenticated: false,\r\n    user: null,\r\n    token: null\r\n  });\r\n\r\n  // Initialize auth state from localStorage on app load\r\n  useEffect(() => {\r\n    const user = localStorage.getItem('user');\r\n    if (user) {\r\n      try {\r\n        const userData = JSON.parse(user);\r\n        setAuth({\r\n          isAuthenticated: true,\r\n          user: userData,\r\n          token: userData.token || null\r\n        });\r\n        \r\n        // Set the default authorization header for axios\r\n        if (userData.token) {\r\n          axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${userData.token}`;\r\n        }\r\n      } catch (error) {\r\n        console.error('Error parsing user data from localStorage:', error);\r\n        localStorage.removeItem('user');\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Update auth state handler\r\n  const updateAuth = (authData) => {\r\n    setAuth(authData);\r\n    \r\n    // Update axios default headers when auth changes\r\n    if (authData.isAuthenticated && authData.user?.token) {\r\n      axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${authData.user.token}`;\r\n    } else {\r\n      delete axiosInstance.defaults.headers.common['Authorization'];\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ ...auth, setAuth: updateAuth }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACjE,MAAO,CAAAC,aAAa,KAAM,gBAAgB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE3C,MAAO,MAAM,CAAAC,WAAW,cAAGN,aAAa,CAAC,CAAC,CAE1C,MAAO,MAAM,CAAAO,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,CAC/BW,eAAe,CAAE,KAAK,CACtBC,IAAI,CAAE,IAAI,CACVC,KAAK,CAAE,IACT,CAAC,CAAC,CAEF;AACAZ,SAAS,CAAC,IAAM,CACd,KAAM,CAAAW,IAAI,CAAGE,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CACzC,GAAIH,IAAI,CAAE,CACR,GAAI,CACF,KAAM,CAAAI,QAAQ,CAAGC,IAAI,CAACC,KAAK,CAACN,IAAI,CAAC,CACjCF,OAAO,CAAC,CACNC,eAAe,CAAE,IAAI,CACrBC,IAAI,CAAEI,QAAQ,CACdH,KAAK,CAAEG,QAAQ,CAACH,KAAK,EAAI,IAC3B,CAAC,CAAC,CAEF;AACA,GAAIG,QAAQ,CAACH,KAAK,CAAE,CAClBX,aAAa,CAACiB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,CAAG,UAAUL,QAAQ,CAACH,KAAK,EAAE,CACrF,CACF,CAAE,MAAOS,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4CAA4C,CAAEA,KAAK,CAAC,CAClER,YAAY,CAACU,UAAU,CAAC,MAAM,CAAC,CACjC,CACF,CACF,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAC,UAAU,CAAIC,QAAQ,EAAK,KAAAC,cAAA,CAC/BjB,OAAO,CAACgB,QAAQ,CAAC,CAEjB;AACA,GAAIA,QAAQ,CAACf,eAAe,GAAAgB,cAAA,CAAID,QAAQ,CAACd,IAAI,UAAAe,cAAA,WAAbA,cAAA,CAAed,KAAK,CAAE,CACpDX,aAAa,CAACiB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,CAAG,UAAUK,QAAQ,CAACd,IAAI,CAACC,KAAK,EAAE,CAC1F,CAAC,IAAM,CACL,MAAO,CAAAX,aAAa,CAACiB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,CAC/D,CACF,CAAC,CAED,mBACEjB,IAAA,CAACC,WAAW,CAACuB,QAAQ,EAACC,KAAK,CAAE,CAAE,GAAGpB,IAAI,CAAEC,OAAO,CAAEe,UAAW,CAAE,CAAAjB,QAAA,CAC3DA,QAAQ,CACW,CAAC,CAE3B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}